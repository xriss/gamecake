/*+-----------------------------------------------------------------------------------------------------------------+*/
//
// (C) Kriss@XIXs.com 2013
//
/*+-----------------------------------------------------------------------------------------------------------------+*/
#include "all.h"




/*+-----------------------------------------------------------------------------------------------------------------+*/
//
// allocate an morph
//
/*+-----------------------------------------------------------------------------------------------------------------+*/
bool t3d_morph::setup(void)
{
	DMEM_ZERO(this);

	return true;
}

/*+-----------------------------------------------------------------------------------------------------------------+*/
//
// allocate an morph
//
/*+-----------------------------------------------------------------------------------------------------------------+*/
bool t3d_morph::reset(void)
{
	clean();
	return setup();
}

/*+-----------------------------------------------------------------------------------------------------------------+*/
//
// allocate an morph
//
/*+-----------------------------------------------------------------------------------------------------------------+*/
void t3d_morph::clean(void)
{
	if(morphs_xox) { free(morphs_xox); morphs_xox=0; }
}





/*+-----------------------------------------------------------------------------------------------------------------+*/
//
// allocate an morph
//
/*+-----------------------------------------------------------------------------------------------------------------+*/
t3d_morph *thunk3d::AllocMorph(void)
{
t3d_morph *ret;


	if(!(ret=(t3d_morph *)morphs->alloc()))
	{
		DBG_Error("Failed to allocate thunk3D.morph.\n");
		goto bogus;
	}

	if(!ret->setup())
	{
		DBG_Error("Failed to setup thunk3D.morph.\n");
		goto bogus;
	}

	DLIST_PASTE(morphs->atoms->last,ret,0);

	return ret;

bogus:
	FreeMorph(ret);
	return 0;
}

/*+-----------------------------------------------------------------------------------------------------------------+*/
//
// free an morph
//
/*+-----------------------------------------------------------------------------------------------------------------+*/
void thunk3d::FreeMorph(t3d_morph *item)
{
	if(item)
	{
		DLIST_CUT(item);

		item->clean();

		morphs->free((llatom*)item);
	}
}





